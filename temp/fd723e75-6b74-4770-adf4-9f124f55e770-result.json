{"name": "正确获取所有商品优选数据", "status": "failed", "statusDetails": {"message": "AssertionError: assert '暂未登录或token已经过期' == '操作成功'\n  - 操作成功\n  + 暂未登录或token已经过期", "trace": "self = <test_case.test_case.TestCase object at 0x0000014C1FB3E160>\ncase = {'case_controller': '/prefrenceArea/listAll', 'case_desc': '', 'case_fun': '获取所有商品优选', 'case_moudle': '商品优选管理', ...}\n\n    @pytest.mark.parametrize('case', TestCaseData.getExcelCases())\n    def test_excel(self, case):\n        \"\"\"\n        执行测试用例\n        :return:\n        \"\"\"\n        print('开始用例测试', case)\n        # 请求方式\n        pattern = case.get('pattern')\n    \n        # 设置用例名称\n        allure.dynamic.feature(case.get('case_moudle'))\n        allure.dynamic.story(case.get('case_fun'))\n        allure.dynamic.title(case.get('case_name'))\n        allure.dynamic.description(case.get('case_desc'))\n    \n        url = self.buildUrl(case)\n    \n        headers = self.buildHeaders(case)\n    \n        param = self.buildParams(case)\n    \n        # ex_headers = case.get('headers').lstrip()\n        # headers = json.loads(ex_headers)\n        # params = json.loads(case.get('param'))\n        if url is not None:\n            if pattern == 'POST':\n                result = requests.post(url, headers=headers, data=json.dumps(param))\n                self.checkResult(case, result.text)\n            elif pattern == 'GET':\n                result = requests.get(url, headers=headers, data=json.dumps(param))\n>               self.checkResult(case, result.text)\n\ntest_case\\test_case.py:68: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <test_case.test_case.TestCase object at 0x0000014C1FB3E160>\ncase = {'case_controller': '/prefrenceArea/listAll', 'case_desc': '', 'case_fun': '获取所有商品优选', 'case_moudle': '商品优选管理', ...}\nresponse_text = '{\"code\":200,\"message\":\"操作成功\",\"data\":[{\"id\":1,\"name\":\"让音质更出众\",\"subTitle\":\"音质不打折 完美现场感\",\"sort\":null,\"showStatus\":1,\"pic...ll,\"showStatus\":null,\"pic\":null},{\"id\":4,\"name\":\"让音质更出众44\",\"subTitle\":null,\"sort\":null,\"showStatus\":null,\"pic\":null}]}'\n\n    @allure.step('结果校验')\n    def checkResult(self, case, response_text):\n        \"\"\"\n        结果校验\n        :param response_text:  返回结果体\n        :param case:           用例参数\n        :return:\n        \"\"\"\n        result_key = case.get('result')\n        expect = case.get('expect')\n        result_json = json.loads(response_text)\n        if case.get('case_number') == 'T001':\n            token = result_json.get('data').get('tokenHead') + result_json.get('data').get('token')\n            self.setEnrimentValue('token', token)\n>       assert expect == result_json.get(result_key)\nE       AssertionError: assert '暂未登录或token已经过期' == '操作成功'\nE         - 操作成功\nE         + 暂未登录或token已经过期\n\ntest_case\\test_case.py:113: AssertionError"}, "steps": [{"name": "构建请求路径", "status": "passed", "parameters": [{"name": "case", "value": "{'case_number': 'T003', 'case_moudle': '商品优选管理', 'case_fun': '获取所有商品优选', 'case_name': '正确获取所有商品优选数据', 'case_desc': '', 'case_url': 'http://admin-api.macrozheng.com', 'case_controller': '/prefrenceArea/listAll', 'pattern': 'GET', 'headers': '{\\n\"Content-Type\":\"application/json\",\\n\"Authorization\": \"${token}\"\\n        }', 'param': '', 'result': 'message', 'expect': '暂未登录或token已经过期', 'trust_result': '', 'floor': ''}"}], "start": 1609405879156, "stop": 1609405879156}, {"name": "构建请求头", "status": "passed", "parameters": [{"name": "case", "value": "{'case_number': 'T003', 'case_moudle': '商品优选管理', 'case_fun': '获取所有商品优选', 'case_name': '正确获取所有商品优选数据', 'case_desc': '', 'case_url': 'http://admin-api.macrozheng.com', 'case_controller': '/prefrenceArea/listAll', 'pattern': 'GET', 'headers': '{\\n\"Content-Type\":\"application/json\",\\n\"Authorization\": \"${token}\"\\n        }', 'param': '', 'result': 'message', 'expect': '暂未登录或token已经过期', 'trust_result': '', 'floor': ''}"}], "start": 1609405879157, "stop": 1609405879161}, {"name": "构建请求参数", "status": "passed", "parameters": [{"name": "case", "value": "{'case_number': 'T003', 'case_moudle': '商品优选管理', 'case_fun': '获取所有商品优选', 'case_name': '正确获取所有商品优选数据', 'case_desc': '', 'case_url': 'http://admin-api.macrozheng.com', 'case_controller': '/prefrenceArea/listAll', 'pattern': 'GET', 'headers': '{\\n\"Content-Type\":\"application/json\",\\n\"Authorization\": \"${token}\"\\n        }', 'param': '', 'result': 'message', 'expect': '暂未登录或token已经过期', 'trust_result': '', 'floor': ''}"}], "start": 1609405879161, "stop": 1609405879161}, {"name": "结果校验", "status": "failed", "statusDetails": {"message": "AssertionError: assert '暂未登录或token已经过期' == '操作成功'\n  - 操作成功\n  + 暂未登录或token已经过期\n", "trace": "  File \"D:\\python3.9\\lib\\site-packages\\allure_commons\\_allure.py\", line 157, in impl\n    return func(*a, **kw)\n  File \"E:\\python_work\\auto_interface\\V1.0.1\\test_case\\test_case.py\", line 113, in checkResult\n    assert expect == result_json.get(result_key)\n"}, "parameters": [{"name": "case", "value": "{'case_number': 'T003', 'case_moudle': '商品优选管理', 'case_fun': '获取所有商品优选', 'case_name': '正确获取所有商品优选数据', 'case_desc': '', 'case_url': 'http://admin-api.macrozheng.com', 'case_controller': '/prefrenceArea/listAll', 'pattern': 'GET', 'headers': '{\\n\"Content-Type\":\"application/json\",\\n\"Authorization\": \"${token}\"\\n        }', 'param': '', 'result': 'message', 'expect': '暂未登录或token已经过期', 'trust_result': '', 'floor': ''}"}, {"name": "response_text", "value": "'{\"code\":200,\"message\":\"操作成功\",\"data\":[{\"id\":1,\"name\":\"让音质更出众\",\"subTitle\":\"音质不打折 完美现场感\",\"sort\":null,\"showStatus\":1,\"pic\":null},{\"id\":2,\"name\":\"让音质更出众22\",\"subTitle\":\"让音质更出众22\",\"sort\":null,\"showStatus\":null,\"pic\":null},{\"id\":3,\"name\":\"让音质更出众33\",\"subTitle\":null,\"sort\":null,\"showStatus\":null,\"pic\":null},{\"id\":4,\"name\":\"让音质更出众44\",\"subTitle\":null,\"sort\":null,\"showStatus\":null,\"pic\":null}]}'"}], "start": 1609405879320, "stop": 1609405879325}], "start": 1609405879156, "stop": 1609405879325, "uuid": "e44095f3-a2c5-4757-9028-519a1291bc97", "historyId": "899df1a120f8586178240f0a03519cc7", "testCaseId": "3eda8e63bd9a4314c2b5a24d7dc1b926", "fullName": "test_case.test_case.TestCase#test_excel", "labels": [{"name": "feature", "value": "商品优选管理"}, {"name": "story", "value": "获取所有商品优选"}, {"name": "parentSuite", "value": "test_case"}, {"name": "suite", "value": "test_case"}, {"name": "subSuite", "value": "TestCase"}, {"name": "host", "value": "LAPTOP-TBMD39IH"}, {"name": "thread", "value": "19336-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_case.test_case"}]}